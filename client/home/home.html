<template name="Home">
  {{> logo}}
  {{> parallax}}
  {{> intro}}
  {{> meetingsMade}}
  {{> people}}
</template>

<template name="parallax">
  <div class="parallax-container">
    <div class="parallax"><img src="/img/parallax/{{randomParallaxImage}}.jpg"></div>
    <div class="parallax-overlay"></div>
  </div>
</template>

<template name="logo">
    <div class="ui center aligned logo">
      <img src="/img/logo.png" class="ui centered image brand-image"/>
      <h2 class="brand-title">Coffee@CU</h2>
    </div>
</template>

<template name="intro">
  <div class="welcome">
    {{#markdown}}{{welcome}}{{/markdown}}
  </div>
</template>

<template name="meetingsMade">
  <div class="meetings-made">
    <div class="ui centered grid">
      <div class="ui inverted large statistic">
        <div class="value">
          {{meetings}}
        </div>
        <div class="label">
          meetings made
        </div>
      </div>
    </div>
  </div>
</template>

<!-- Show the user profiles as card on the home page -->
<template name="people">
  <div class="people-home">
    <div class="searchbox">
      <h3 class="ui header">Search for Columbia students to meet</h3>
      <!-- Allow all fields of all profiles to be searched -->
      {{> EasySearch.Input index=peopleIndex attributes=inputAttributes }}
    </div>
    <div class="ui four column doubling stackable grid container">

      <!-- For each profile, fill this template -->
      {{#EasySearch.Each index=peopleIndex }}
      <div class="five wide column">
        <div id="contact" class="ui raised segment person">
          <div class="ui centered grid">
            {{#if makeVisible}}
              <div class="row">
                <img src="{{image}}" class="profilepic ui rounded image"/>
              </div>
            {{else}}
              <div class="row">
                <img src="/img/roaree.jpg" class="profilepic ui rounded image"/>
              </div>
            {{/if}}
            <div class="row">
              <h2 class="name">{{name}}</h2>
            </div>
          </div>
        </div>
      </div>
      {{/EasySearch.Each}}
    </div>

    {{> EasySearch.LoadMore index=peopleIndex attributes=loadButtonAttributes count=12}}

    {{#EasySearch.IfNoResults index=peopleIndex}}
      <div class="no-results">No results found</div>
    {{/EasySearch.IfNoResults}}
  </div>
  <!-- Allow modals to be used in this template -->
  {{> uniPrompt}}
</template>

<!-- Template defines modals which appear when a profile card is pressed -->
<template name="uniPrompt">

<!--   First modal shows the profile
  getUserProperty(String property) passes information from the Template.people > Session > this template -->
  <div class="ui coupled first modal">
    <div class="header">
      {{getUserProperty "name"}}
    </div>
<!--     if profile is public, fill all available fields -->
    {{#if getUserProperty "make_public"}}
      <div class="image scrolling content">
        <div class="ui tiny bordered image">
          <img src='{{getUserProperty "image"}}'>
        </div>
        <div class="description">
          <div class="ui header"> Learn more about {{getUserProperty "name"}}</div>
              <p>{{getUserProperty "school"}} {{getUserProperty "year"}}</p>
              <p><b>Studies:</b> {{getUserProperty "major"}}</p>
              {{#if getUserProperty "pronounsBox"}}
                <p><b>Pronouns:</b> {{getUserProperty "pronounsBox"}}</p>
              {{/if}}
              <p><b>About:</b> {{getUserProperty "about"}}</p>
              <p><b>Likes:</b> {{getUserProperty "likes"}}</p>
              <p><b>Contact me for:</b> {{getUserProperty "contactfor"}}</p>
              <p><b>Availability:</b> {{getUserProperty "availability"}}</p>
              {{#if getUserProperty "facebook"}}
                <button class="ui facebook icon button">
                  <a target="_blank" href='{{getUserProperty "facebook"}}'> <i class="facebook icon"></i></a>
                </button>
              {{/if}}
              {{#if getUserProperty "twitter"}}
                <button class="ui twitter icon button">
                  <a target="_blank" href='{{getUserProperty "twitter"}}'> <i class="twitter icon"></i></a>
                </button>
              {{/if}}
              {{#if getUserProperty "linkedin"}}
                <button class="ui linkedin icon button">
                  <a target="_blank" href='{{getUserProperty "linkedin"}}'> <i class="linkedin icon"></i></a>
                </button>
              {{/if}}
              {{#if getUserProperty "website"}}
                <button class="ui icon button">
                  <a target="_blank" href='{{getUserProperty "website"}}'> <i class="cloud icon"></i></a>
                </button>
              {{/if}}
        </div>
      </div>

<!--     if the profile is private, show default   -->
    {{else}}
    <div class="image content">
      <div class="ui tiny bordered image">
        <img src="/img/roaree.jpg">
      </div>
      <div class="description">
        <div class="ui header">This profile is private</div>
        <b>This profile is private. </b> <p>To learn more about this person, please sign in with your Columbia email address.</p>
      </div>
    </div>
    {{/if}}
    <div class="actions">
      <!-- if the user is not logged in, do not show the "Grab Coffee button" -->
      {{#if currentUser}}
        <button id="cancel" class="ui negative button">Cancel</button>
        <button id="submitRequest" class="ui primary button">Grab Coffee</button>
      {{else}}
        <button id="cancel" class="ui negative button"> You must sign in to grab coffee</button>
      {{/if}}
    </div>
  </div>

<!-- Second modal sens the Coffee request -->
  <div class="ui coupled second modal">
      <div class="header">Enter a message to go along with your request.</div>
    <div class="content">
      <div class="field">
        <input type="text" name="Additional Message" id="additionalMessage" />
        <label for="Additional Message">Additional Message</label>
        <div class="field recaptcha-box">
          <label>Complete the reCAPTCHA before sending your request</label>
          {{> reCAPTCHA widget_id="1"}}
        </div>
      </div>
      <div class="actions">
        <button id="cancel" class="ui negative close cancel button">Cancel</button>
        <button id="submitRequest" class="ui primary approve button">Grab Coffee</button>
      </div>
    </div>
  </div>
</template>
